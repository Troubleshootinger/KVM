apt-get install qemu-kvm libvirt-bin virtinst bridge-utils

virt-install --name trusty1404 --hvm --ram 1024 --vcpus 1 --disk path=/virt/disks/trusty1404.img,format=qcow2,size=10 \
--network network:default --accelerate --graphics vnc,listen=0.0.0.0,port=5911 \
--cdrom /virt/images/ubuntu-14.04.2-server-amd64.iso -d

virt-install --name trusty1404 --hvm --ram 1024 --vcpus 1 --disk path=/virt/disks/trusty1404.img,format=qcow2,size=10 \
--network bridge:br0 --accelerate --graphics vnc,listen=0.0.0.0,port=5911 \
--cdrom /virt/images/ubuntu-14.04.2-server-amd64.iso -d

virsh destroy trusty1404
virsh undefine trusty1404

virsh shutdown trusty1404
virt-clone --original=trusty1404 --name=clone0 --file=/virt/disks/clone0.img

# pool

virsh pool-create-as --name master_pool --type dir --target /virt/disks
virsh pool-info master_pool
virsh pool-start master_pool
virsh pool-list

# snapshot

virsh snapshot-create-as trusty1404 snapshot1
virsh snapshot-revert trusty1404 snapshot1

# bridged networking

auto eth0
iface eth0 inet manual

auto br0
iface br0 inet static
address ...
netmask ...
gateway ...
bridge_ports eth0
bridge_stp off
bridge_fd 0
bridge_maxwait 0

dns-nameservers ...

reboot

brctl show

# random mac
echo $RANDOM | md5sum | sed 's/\(..\)/&:/g' | cut -c1-17

# update vm config
vim /etc/libvirt/qemu/trusty1404.xml

# dump vm config
virsh dumpxml trusty1404 > /etc/libvirt/qemu/trusty1404-2.xml

virsh edit trusty1404 # !!!

# Resize disk space  
virsh vol-resize your_volume_name.img 100G --pool master_pool  
